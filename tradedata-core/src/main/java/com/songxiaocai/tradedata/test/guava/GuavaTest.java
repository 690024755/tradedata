package com.songxiaocai.tradedata.test.guava;/* * Description:com.songxiaocai.tradedata.test.guava * @Date Create on 20:01 * @author <a href="mailto:yangyi@zuozh.com">yangyi</a> * @Version JDK 1.7 * @since version 1.0 Copyright 2019-04-04日ZZJR All Rights Reserved. */import com.google.common.cache.CacheBuilder;import com.google.common.cache.CacheLoader;import com.google.common.cache.LoadingCache;import com.songxiaocai.tradedata.application.repository.SxcUserRepository;import com.songxiaocai.tradedata.service.params.SxcUserInfoDTO;import lombok.extern.slf4j.Slf4j;import org.springframework.beans.factory.annotation.Autowired;import org.springframework.test.context.ContextConfiguration;import org.springframework.test.context.testng.AbstractTestNGSpringContextTests;import org.testng.annotations.Test;import java.util.HashMap;import java.util.concurrent.TimeUnit;@Slf4j@ContextConfiguration(locations = {"/META-INF/spring/tradedata-context.xml"})public class GuavaTest extends AbstractTestNGSpringContextTests {	@Autowired	private SxcUserRepository sxcUserRepository;	private LoadingCache<String, SxcUserInfoDTO> caches = CacheBuilder.newBuilder()			.maximumSize(2000).expireAfterWrite(20, TimeUnit.SECONDS)			.build(new CacheLoader<String, SxcUserInfoDTO>() {				HashMap<String, Object> hs =new HashMap<String, Object>(){{					put("mobilePhone","13093863511");					put("userType",1);				}};				@Override				public SxcUserInfoDTO load(String Phone) throws Exception {					return sxcUserRepository.getByMobilePhone(hs);				}			});	@Test	public void test1() {		SxcUserInfoDTO yy = null;		try {			yy = caches.get("13093863511");		} catch (Exception e) {			System.out.println("抛出异常");		}	}}